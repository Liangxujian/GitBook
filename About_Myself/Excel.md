# Excel

## 字符串截取

字符串的截取就是从一个给定字符串中截取一部分内容，常见的比如截取身份证号中的年月日信息，可采取的函数有MID、LEFT和RIGHT。

MID是middle的缩写，意思取一个字符串中间的一部分，使用方法是=MID(字符串，起始位置，截取长度)，起始位置从1开始。

LEFT是从左边截取给定的一个定符串，RIGHT与LEFT相反，是从右边截取给定的一个字符串，需要指定截取的长度，使用方法是=LEFT(字符串,截取长度)或=RIGHT(字符串,截取长度)。

![101724134_1](.\assets\101724134_1.jpg)

## 字符串的拼接

拼接就是将两个或多个单元格或字符串连接一起，拼接的方法是使用concatenate函数或直接使用&符号进行连接，如下图所示，其中”-“是一个单独的字符串“减号”：

![101724134_2](.\assets\101724134_2.jpg)

## 字符串的比较

经常遇到两个单元格的内容进行比较的情况，如果使用眼睛判断比较麻烦，也可能犯错误，正确的方法是使用EXACT函数或等号来判断。

![101724134_3](.\assets\101724134_3.jpg)

EXACT进行对比时，区分大小写，公式2中使用等号对比时，不区分大小写。

## 其它一些字符串函数

### 求字符串长度

使用len函数求一个字符串的长度，在中文语言状态下，汉字、数字、符号都占一位，注意前后空格也占位置，使用方法是=LEN(A1)。

### 去前后面的空格

在对手工填写的内容进行对比时，经常发现明明看着一样，但是对比起来不一样或者用VLOOKUP查不着，那可能就是前面后面有空格，使用TRIM函数可以去掉前后的空格，使用方法是=TRIM(A1)。

## 字符串条件判断

### IF-ELSE 判断

````bash
=IF(A1="S",1.2,1) # A1 == "S" ? 1.2 : 1
````

### SWITCH 判断

```bash
# 利用IF函数多级嵌套判断
=IF(A1="S",1.2,IF(A1="A",1,IF(A1="B",0.95,IF(A1="C",0.9,IF(A1="D",0.85,)))))
# 使用字典函数VLOOKUP
=VLOOKUP(查阅值、包含查阅值的区域、区域中包含返回值的列号、近似匹配指定 TRUE 或者为精确匹配指定 FALSE【可选】)
=VLOOKUP(A7,A2:B5,2,FALSE)
# 以上函数表示：以A7单元格中的值为key，以A2到B5单元格（2列）的范围为字典（key-value），FALSE表示精确匹配，返回匹配到的value
=XLOOKUP(lookup_value, lookup_array, return_array, [if_not_found], [match_mode], [search_mode])
# if_not_found：【可选】如果找不到有效的匹配项，则返回这个值，如果没有设置该参数，则返回#N/A
# match_mode：【可选】指定匹配类型：0：完全匹配。如果未找到，则返回 #N/A。这是默认选项；
#                               -1：完全匹配。如果没有找到，则返回下一个较小的项；
#                                1：完全匹配。如果没有找到，则返回下一个较大的项；
#                                2：通配符匹配，其中 *, ? 和 ~ 有特殊含义。
# search_mode：【可选】指定要使用的搜索模式：1：从第一项开始执行搜索。这是默认选项；
#                                       -1：从最后一项开始执行反向搜索；
#                                        2：执行依赖于 lookup_array 按升序排序的二进制搜索。如果未排序，将返回无效结果。
=XLOOKUP(F2,B2:B11,D2:D11)
# 以上函数表示：以F2单元格中的值为key，以B2到B11单元格中的值为key_array，以D2到D11单元格中的值为value_array
```



